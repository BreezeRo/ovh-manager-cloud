{"remainingRequest":"/Users/jleveugle/Documents/Work/github/ovh-ux/ovh-manager-cloud/node_modules/babel-loader/lib/index.js??ref--10-1!/Users/jleveugle/Documents/Work/github/ovh-ux/ovh-manager-cloud/node_modules/cache-loader/dist/cjs.js!/Users/jleveugle/Documents/Work/github/ovh-ux/ovh-manager-cloud/node_modules/@ovh-ux/manager-webpack-config/loaders/ui-router-translations.js??ref--11-1!/Users/jleveugle/Documents/Work/github/ovh-ux/ovh-manager-cloud/client/app/cloud/project/openstack/users/openrc/openstack-users-openrc.controller.js","dependencies":[{"path":"/Users/jleveugle/Documents/Work/github/ovh-ux/ovh-manager-cloud/client/app/cloud/project/openstack/users/openrc/openstack-users-openrc.controller.js","mtime":1539717142045},{"path":"/Users/jleveugle/Documents/Work/github/ovh-ux/ovh-manager-cloud/.babelrc","mtime":1539717141926},{"path":"/Users/jleveugle/Documents/Work/github/ovh-ux/ovh-manager-cloud/node_modules/cache-loader/dist/cjs.js","mtime":1539679504371},{"path":"/Users/jleveugle/Documents/Work/github/ovh-ux/ovh-manager-cloud/node_modules/babel-loader/lib/index.js","mtime":1539597349061},{"path":"/Users/jleveugle/Documents/Work/github/ovh-ux/ovh-manager-cloud/node_modules/cache-loader/dist/cjs.js","mtime":1539679504371},{"path":"/Users/jleveugle/Documents/Work/github/ovh-ux/ovh-manager-cloud/node_modules/@ovh-ux/manager-webpack-config/loaders/ui-router-translations.js","mtime":1539950864368}],"contextDependencies":[],"result":["angular.module('managerApp').controller('OpenstackUsersOpenrcCtrl', [\"$scope\", \"OvhApiCloud\", \"$httpParamSerializer\", \"$uibModalInstance\", \"CONFIG_API\", \"openstackUser\", \"$stateParams\", \"$translate\", \"URLS\", \"OvhApiMe\", \"RegionService\", function OpenstackUsersOpenrcCtrl($scope, OvhApiCloud, $httpParamSerializer, $uibModalInstance, CONFIG_API, openstackUser, $stateParams, $translate, URLS, OvhApiMe, RegionService) {\n  var self = this;\n  self.regionService = RegionService;\n  self.openstackUser = openstackUser;\n  self.projectId = $stateParams.projectId;\n  self.form = {\n    regions: []\n  };\n  self.data = {\n    region: null,\n    guideURL: null\n  };\n  self.loaders = {\n    regions: false,\n    download: false,\n    guide: false\n  };\n\n  function initGuideURL() {\n    self.loaders.guide = true;\n    OvhApiMe.v6().get().$promise.then(function (me) {\n      var lang = me.ovhSubsidiary;\n      self.data.guideURL = URLS.guides.openstack[lang];\n    }).finally(function () {\n      self.loaders.guide = false;\n    });\n  }\n\n  function getRegions() {\n    self.loaders.regions = true;\n    return OvhApiCloud.Project().Region().v6().query({\n      serviceName: self.projectId\n    }).$promise.then(function (regions) {\n      self.form.regions = regions;\n\n      if (self.form.regions) {\n        self.data.region = _.first(self.form.regions);\n      }\n    }).finally(function () {\n      self.loaders.regions = false;\n    });\n  }\n\n  function init() {\n    initGuideURL();\n    getRegions();\n  }\n\n  function buildOpenrcUrl() {\n    var url = [(_.find(CONFIG_API.apis, {\n      serviceType: 'aapi'\n    }) || {}).urlPrefix, OvhApiCloud.Project().User().Aapi().services.openrc.url, '?', $httpParamSerializer({\n      region: self.data.region,\n      download: 1\n    })].join('');\n    var replacements = {\n      serviceName: self.projectId,\n      userId: openstackUser.id\n    }; // Build URL\n\n    Object.keys(replacements).forEach(function (paramName) {\n      url = url.replace(\":\".concat(paramName), replacements[paramName]);\n    });\n    return url;\n  }\n\n  self.downloadOpenrcFile = function () {\n    var url = buildOpenrcUrl();\n    var link = document.createElement('a');\n    link.setAttribute('href', url);\n    link.style.visibility = 'hidden';\n    document.body.appendChild(link);\n    link.click();\n    document.body.removeChild(link);\n    self.close();\n  };\n\n  self.close = function () {\n    $uibModalInstance.close();\n  };\n\n  self.cancel = function () {\n    $uibModalInstance.dismiss();\n  };\n\n  init();\n}]);",null]}